<!DOCTYPE html>
<html>
<head>
    <title>Email Info</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
<h3>Email Info</h3>
<p><strong>Subject:</strong> <span id="subject">Loading...</span></p>
<p><strong>From:</strong> <span id="from"></span></p>
<p><strong>To:</strong> <span id="to"></span></p>
<p><strong>CC:</strong> <span id="cc"></span></p>
<h4>Body (Plain Text):</h4>
<pre id="bodyText"></pre>

<script>
    Office.onReady(info => {
      if (info.host === Office.HostType.Outlook) {
        const item = Office.context.mailbox.item;

        // Subject
        item.subject.getAsync(result => {
          if (result.status === Office.AsyncResultStatus.Succeeded) {
            document.getElementById("subject").innerText = result.value;
          }
        });

        // From
        const from = item.from;
        document.getElementById("from").innerText = `${from.displayName} <${from.emailAddress}>`;

        // To Recipients
        const toRecipients = item.to || [];
        document.getElementById("to").innerText =
          toRecipients.map(r => `${r.displayName} <${r.emailAddress}>`).join(', ');

        // CC Recipients
        const ccRecipients = item.cc || [];
        document.getElementById("cc").innerText =
          ccRecipients.map(r => `${r.displayName} <${r.emailAddress}>`).join(', ');

        // Body
        item.body.getAsync(Office.CoercionType.Text, result => {
          if (result.status === Office.AsyncResultStatus.Succeeded) {
            document.getElementById("bodyText").innerText = result.value;
          }
        });
      }
    });
</script>
</body>
</html>
